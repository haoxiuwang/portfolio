---
title: 'Rewrite nodejs require function'
subtitle: 'Prism with Next.js subtitle'
date: '2020/01/15'
description: 'These codes is an implementation of <u>nodejs require function</u> ...'
image: '/assets/images/nodejs.png'
tags:
  - "require"
  - "module"
  - "nodejs"
github: "https://github.com/wangfei20/nodejs-lab/blob/master/frequire.js"
demo: "github"
---

For nodejs code, `require` function might be most mysterious, and mostly making beginer confused. What will happen when `require("express")` is excuted, my codes maybe too far simple, but can give the most important clues in `require` function.

```nodejs
var path = require("path")
var fs = require("fs")
function frequire(file){
    var codes = fs.readFileSync(path.join(__dirname, file), 'utf-8')
    var mod = new Function("exports","module","require",
    codes + `
      var i;
      for(i in exports){break;}
      if(i == null)
      return module.exports
      else
      return exports
    `)
    var obj = {mod}
    return obj.mod({},{"exports":{}},frequire)
}
module.exports = frequire
```
